{
  "version": "2.4.1",
  "summary": {
    "title": "Stellar-Pay Scenario based Threat Model",
    "owner": "Tanatswa",
    "description": "This threat model represents a web-based digital banking application based on the StellarPay scenario. The model was created using OWASP Threat Dragon and follows the STRIDE methodology to proactively identify and address potential security threats.\n\nThe model includes:\n\nCore components such as login forms, user accounts, payment APIs, and database servers.\n\nData flows between users, the application server, external banking systems, and third-party services.\n\nTrust boundaries that separate users, system components, and external entities.\n\nA detailed analysis of assets, entry points, and threats, helping to surface risks like spoofing, data tampering, and denial of service.\n\nThe goal of this model is to improve the application’s security posture before deployment by identifying vulnerabilities, proposing mitigations, and updating system design to reflect security best practices.\n\n",
    "id": 0
  },
  "detail": {
    "contributors": [],
    "diagrams": [
      {
        "id": 0,
        "title": "Capitec-Based STRIDE Threat Model for StellarPay",
        "diagramType": "STRIDE",
        "placeholder": "New STRIDE diagram description",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "version": "2.4.1",
        "cells": [
          {
            "position": {
              "x": 560,
              "y": 120
            },
            "size": {
              "width": 130,
              "height": 130
            },
            "attrs": {
              "text": {
                "text": "Stellar Pay System"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 1,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "3c075236-72be-482d-a36b-b6901a0d0c7e"
                },
                {
                  "group": "right",
                  "id": "7bf68822-bca5-40e3-81d3-fb87ffaeabe3"
                },
                {
                  "group": "bottom",
                  "id": "4a2aa094-4e23-4643-8bb2-f0e84a07afe5"
                },
                {
                  "group": "left",
                  "id": "b904bbd8-3d54-4099-964a-f79a3b91e004"
                }
              ]
            },
            "id": "34ad303e-cd09-44c6-b185-55ec2f7b3682",
            "data": {
              "type": "tm.Process",
              "name": "Stellar Pay System",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": 980,
              "y": -10
            },
            "size": {
              "width": 110,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Login Process"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 3,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "3c075236-72be-482d-a36b-b6901a0d0c7e"
                },
                {
                  "group": "right",
                  "id": "7bf68822-bca5-40e3-81d3-fb87ffaeabe3"
                },
                {
                  "group": "bottom",
                  "id": "4a2aa094-4e23-4643-8bb2-f0e84a07afe5"
                },
                {
                  "group": "left",
                  "id": "b904bbd8-3d54-4099-964a-f79a3b91e004"
                }
              ]
            },
            "id": "560d707d-1436-426c-872f-e7853ddd722c",
            "data": {
              "type": "tm.Process",
              "name": "Login Process",
              "description": " Subprocess that performs credential checks and returns results.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "3e5fcdee-6f77-4de8-a3a6-5a4ac81646d5",
                  "title": "Denial Of Service",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Denial of service",
                  "description": "Slows down system via brut-force attack to figure out potential valid credentials or form spamming",
                  "mitigation": "1. Appropriate authentication\n2. Appropriate authorization\n3. Filtering\n4. Throttling\n5. Quality of service",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 8,
                  "score": ""
                },
                {
                  "id": "15b91f56-fe78-496c-95aa-a7bd7d796ab4",
                  "title": "Spoofing",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": " Login bypass through fake inputs, then poses as valid user",
                  "mitigation": "1. Appropriate authentication\n2. Protect secret data\n3. Don’t store secrets",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 9,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 0,
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 1,
                "denialOfService": 1,
                "elevationOfPrivilege": 0
              }
            }
          },
          {
            "position": {
              "x": 955,
              "y": 299
            },
            "size": {
              "width": 170,
              "height": 140
            },
            "attrs": {
              "text": {
                "text": "Stella Pay database"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 4,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "3c075236-72be-482d-a36b-b6901a0d0c7e"
                },
                {
                  "group": "right",
                  "id": "7bf68822-bca5-40e3-81d3-fb87ffaeabe3"
                },
                {
                  "group": "bottom",
                  "id": "4a2aa094-4e23-4643-8bb2-f0e84a07afe5"
                },
                {
                  "group": "left",
                  "id": "b904bbd8-3d54-4099-964a-f79a3b91e004"
                }
              ]
            },
            "id": "c0bcc07f-ffb9-41c9-a8c3-b1e3e61b0302",
            "data": {
              "type": "tm.Process",
              "name": "Stella Pay database",
              "description": "Main structured store for user accounts, sessions, and transaction data.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "ec3794bd-7341-4a2d-99d5-aaf7cb2e5548",
                  "title": "SQL injection",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "See OWASP Automated Threat #6:\nUsing speed to violate explicit or implicit assumptions about the application’s normal use to achieve unfair individual gain",
                  "mitigation": "1. Appropriate authorization\n2. Hashes\n3. MACs\n4. Digital signatures\n5. Tamper resistant protocols",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 10,
                  "score": ""
                },
                {
                  "id": "d9e88bce-bd86-487e-a6ac-a30948c51a34",
                  "title": "Information Disclosure",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Unencrypted data leaks.",
                  "mitigation": "1. Authorization\n2. Privacy-enhanced protocols\n3. Encryption\n4. Protect secrets\n5. Don’t store secrets",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 11,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 0,
                "tampering": 1,
                "repudiation": 0,
                "informationDisclosure": 1,
                "denialOfService": 0,
                "elevationOfPrivilege": 0
              }
            }
          },
          {
            "position": {
              "x": 975,
              "y": 579
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Stellar Pay Database Files"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 5,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "f9415300-2f69-4be2-a8fc-e20aa07aeb1d"
                },
                {
                  "group": "right",
                  "id": "3538494a-bb76-40e5-a62e-4a7093d2f6d9"
                },
                {
                  "group": "bottom",
                  "id": "81a45194-17b0-4085-8b4a-3d5448e86507"
                },
                {
                  "group": "left",
                  "id": "9894174f-517b-473a-a31d-3d891ed9504b"
                }
              ]
            },
            "id": "3d4fd252-41df-40fb-9462-c95d4fb8a678",
            "data": {
              "type": "tm.Store",
              "name": "Stellar Pay Database Files",
              "description": "Raw data files storing backup or persistent system data.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": true,
              "storesInventory": false,
              "threats": [
                {
                  "id": "318d7e66-da9a-425d-8a4a-b574d4cb50a6",
                  "title": "Information Disclosure",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Unprotected backups., make it easy for attacker to view",
                  "mitigation": "1. Authorization\n2. Privacy-enhanced protocols\n3. Encryption\n4. Protect secrets\n5. Don’t store secrets",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 12,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "tools": {
              "items": [
                "boundary",
                "button-remove"
              ],
              "name": null
            }
          },
          {
            "position": {
              "x": 152,
              "y": 40
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "User"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 6,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "4995afd5-a5dc-4a8d-9306-1a3c27ca6fbd"
                },
                {
                  "group": "right",
                  "id": "05c21782-7907-429e-bb35-580962351b5e"
                },
                {
                  "group": "bottom",
                  "id": "69eec925-90af-40b9-afba-081881d8cbca"
                },
                {
                  "group": "left",
                  "id": "4677472f-cef5-4d9e-bdcf-63eac3b0f00c"
                }
              ]
            },
            "id": "fe6fd633-232b-4944-a045-11d1c7d93e71",
            "data": {
              "type": "tm.Actor",
              "name": "User",
              "description": "A registered or guest individual using the platform to log in and initiate transactions.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "providesAuthentication": true,
              "threats": [
                {
                  "id": "7fbd4cb1-4d0b-4492-b8a7-eace02be5f05",
                  "title": "Credential Spoofing",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "Attacker poses as a valid user, using stolen user credentials obtained",
                  "mitigation": "Multi-Factor Authentication\nProtection of secret data\nCAPTCHA\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 1,
                  "score": ""
                },
                {
                  "id": "d1dd59d8-a347-47e0-ab5e-7755cba562b9",
                  "title": "Lack of Accountability",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "Users deny connection to attacks due to poor logging processes",
                  "mitigation": "1. Digital signatures\n2. Timestamps\n3. Audit trails",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 2,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 2,
                "repudiation": 1
              }
            }
          },
          {
            "position": {
              "x": 39.5,
              "y": 359
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Bank"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 7,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "4995afd5-a5dc-4a8d-9306-1a3c27ca6fbd"
                },
                {
                  "group": "right",
                  "id": "05c21782-7907-429e-bb35-580962351b5e"
                },
                {
                  "group": "bottom",
                  "id": "69eec925-90af-40b9-afba-081881d8cbca"
                },
                {
                  "group": "left",
                  "id": "4677472f-cef5-4d9e-bdcf-63eac3b0f00c"
                }
              ]
            },
            "id": "d0e3ed3f-5582-48bf-a1ed-3d19f8a66845",
            "data": {
              "type": "tm.Actor",
              "name": "Bank",
              "description": "Third-party financial entity that validates transaction authenticity.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "providesAuthentication": true,
              "threats": [
                {
                  "id": "eef2e16f-af0f-45ca-ac21-01a6996a3441",
                  "title": "Spoofing",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": " Faked responses from an impersonated bank.",
                  "mitigation": "1. Appropriate authentication\n2. Protect secret data\n3. Don’t store secrets",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 6,
                  "score": ""
                },
                {
                  "id": "6a65a0c7-3a96-4898-9e4e-c65916861331",
                  "title": "Information Disclosure",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "Intercepted validation responses.",
                  "mitigation": "1.Encrypted API (HTTPS + mTLS)\n2. API keys\n3.digital signatures.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 7,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 1,
                "repudiation": 0
              }
            }
          },
          {
            "position": {
              "x": 500,
              "y": 460
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Admin"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 8,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "4995afd5-a5dc-4a8d-9306-1a3c27ca6fbd"
                },
                {
                  "group": "right",
                  "id": "05c21782-7907-429e-bb35-580962351b5e"
                },
                {
                  "group": "bottom",
                  "id": "69eec925-90af-40b9-afba-081881d8cbca"
                },
                {
                  "group": "left",
                  "id": "4677472f-cef5-4d9e-bdcf-63eac3b0f00c"
                }
              ]
            },
            "id": "f0019501-d986-4817-88df-725fe5821e83",
            "data": {
              "type": "tm.Actor",
              "name": "Admin",
              "description": "An internal user with elevated privileges for querying and managing the system.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "providesAuthentication": true,
              "threats": [
                {
                  "id": "8e33841c-a859-40b7-a477-4d279fc9df41",
                  "title": "CAPTCHA defeat",
                  "status": "Open",
                  "severity": "High",
                  "type": "Elevation of privilege",
                  "description": "User's escalate privileges due to lack of proper access controls",
                  "mitigation": "Role-based Access\nRun with least privilege",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 3,
                  "score": ""
                },
                {
                  "id": "ef7a614c-d658-4517-97ee-f135e6c92711",
                  "title": "User privileges escalated",
                  "status": "Open",
                  "severity": "High",
                  "type": "Elevation of privilege",
                  "description": "User's escalate privileges due to lack of proper access controls",
                  "mitigation": "Role-based Access\nRun with least privilege",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 4,
                  "score": ""
                },
                {
                  "id": "95a81714-b4e7-42ed-a023-8497d430bdfb",
                  "title": "Spoofing",
                  "status": "Open",
                  "severity": "TBD",
                  "type": "Spoofing",
                  "description": "User poses as admin to enter system",
                  "mitigation": "1.Input Validation\n2. Multi Factor Authentication\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 5,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 1,
                "repudiation": 0
              }
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Login request",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Login request"
            ],
            "id": "ffe93065-9368-4058-9e63-ecc32ef70e71",
            "source": {
              "x": 265,
              "y": 60
            },
            "target": {
              "cell": "34ad303e-cd09-44c6-b185-55ec2f7b3682",
              "port": "3c075236-72be-482d-a36b-b6901a0d0c7e"
            },
            "vertices": [
              {
                "x": 440,
                "y": 90
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Login Request Response",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Login Request Response"
            ],
            "id": "ba27cf3a-b601-45ff-891f-3c8ecd20e964",
            "source": {
              "cell": "34ad303e-cd09-44c6-b185-55ec2f7b3682",
              "port": "b904bbd8-3d54-4099-964a-f79a3b91e004"
            },
            "target": {
              "cell": "fe6fd633-232b-4944-a045-11d1c7d93e71",
              "port": "05c21782-7907-429e-bb35-580962351b5e"
            },
            "vertices": [
              {
                "x": 400,
                "y": 130
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Validate Transaction Request Response",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Validate Transaction Request Response"
            ],
            "id": "fcd61be8-12ad-46f9-91d1-9b6684903be8",
            "source": {
              "cell": "d0e3ed3f-5582-48bf-a1ed-3d19f8a66845",
              "port": "4995afd5-a5dc-4a8d-9306-1a3c27ca6fbd"
            },
            "target": {
              "cell": "34ad303e-cd09-44c6-b185-55ec2f7b3682",
              "port": "b904bbd8-3d54-4099-964a-f79a3b91e004"
            },
            "vertices": [
              {
                "x": 370,
                "y": 260
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Validate Transaction Request ",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Validate Transaction Request "
            ],
            "id": "5fae49ec-85d2-4dcb-8628-aa0be6334739",
            "source": {
              "x": 590,
              "y": 240
            },
            "target": {
              "cell": "d0e3ed3f-5582-48bf-a1ed-3d19f8a66845",
              "port": "05c21782-7907-429e-bb35-580962351b5e"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Authenticate User()",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Authenticate User()"
            ],
            "id": "ba71e593-afa5-4e7f-a379-3b0fdbe48f6f",
            "source": {
              "x": 690,
              "y": 180
            },
            "target": {
              "cell": "560d707d-1436-426c-872f-e7853ddd722c",
              "port": "b904bbd8-3d54-4099-964a-f79a3b91e004"
            },
            "vertices": [
              {
                "x": 850,
                "y": 100
              },
              {
                "x": 870,
                "y": 100
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Authenticate User() Result",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Authenticate User() Result"
            ],
            "id": "13b28f5a-2afb-43c0-b4bf-3937529daf50",
            "source": {
              "cell": "560d707d-1436-426c-872f-e7853ddd722c",
              "port": "3c075236-72be-482d-a36b-b6901a0d0c7e"
            },
            "target": {
              "cell": "34ad303e-cd09-44c6-b185-55ec2f7b3682",
              "port": "3c075236-72be-482d-a36b-b6901a0d0c7e"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "\n\n\nSQL\n Query to \nauthenticate user\n() use case",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "SQL\n Query to \nauthenticate user\n() use case"
            ],
            "id": "707fad04-3eaf-445b-9c7a-3704338f9fce",
            "source": {
              "x": 1060,
              "y": 100
            },
            "target": {
              "cell": "c0bcc07f-ffb9-41c9-a8c3-b1e3e61b0302",
              "port": "3c075236-72be-482d-a36b-b6901a0d0c7e"
            },
            "vertices": [
              {
                "x": 1060,
                "y": 210
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Result",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Result"
            ],
            "id": "248601e9-42b1-4a07-912a-7f7023f606e1",
            "source": {
              "cell": "c0bcc07f-ffb9-41c9-a8c3-b1e3e61b0302",
              "port": "b904bbd8-3d54-4099-964a-f79a3b91e004"
            },
            "target": {
              "cell": "560d707d-1436-426c-872f-e7853ddd722c",
              "port": "4a2aa094-4e23-4643-8bb2-f0e84a07afe5"
            },
            "vertices": [
              {
                "x": 910,
                "y": 290
              },
              {
                "x": 930,
                "y": 160
              },
              {
                "x": 960,
                "y": 120
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Data"
            ],
            "id": "3165a47f-bc07-448b-b728-d7f0e3d70691",
            "source": {
              "x": 1070,
              "y": 450
            },
            "target": {
              "x": 1070,
              "y": 540
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Data"
            ],
            "id": "66e1a961-0ee1-4e1f-ba97-822cc2f80d4a",
            "source": {
              "x": 990,
              "y": 550
            },
            "target": {
              "x": 1000,
              "y": 470
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "SQL Transaction Query request",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "SQL Transaction Query request"
            ],
            "id": "6d0a61c3-a2ea-4adf-b084-aa8590d6dea4",
            "source": {
              "x": 620,
              "y": 490
            },
            "target": {
              "cell": "c0bcc07f-ffb9-41c9-a8c3-b1e3e61b0302",
              "port": "b904bbd8-3d54-4099-964a-f79a3b91e004"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Result",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Result"
            ],
            "id": "d6c2d126-3c73-452a-9b36-96f8fa3ef71f",
            "source": {
              "x": 980,
              "y": 420
            },
            "target": {
              "cell": "f0019501-d986-4817-88df-725fe5821e83",
              "port": "69eec925-90af-40b9-afba-081881d8cbca"
            },
            "vertices": [
              {
                "x": 870,
                "y": 540
              },
              {
                "x": 780,
                "y": 590
              },
              {
                "x": 730,
                "y": 590
              },
              {
                "x": 680,
                "y": 570
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Login Request",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Login Request"
            ],
            "id": "24b29d54-27c9-496e-a260-e23c5ab1ba82",
            "source": {
              "cell": "f0019501-d986-4817-88df-725fe5821e83",
              "port": "4995afd5-a5dc-4a8d-9306-1a3c27ca6fbd"
            },
            "target": {
              "x": 680,
              "y": 250
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Login Request Response",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Login Request Response"
            ],
            "id": "c1653d47-8de3-4f15-9ee1-e58af8f9240a",
            "source": {
              "cell": "34ad303e-cd09-44c6-b185-55ec2f7b3682",
              "port": "4a2aa094-4e23-4643-8bb2-f0e84a07afe5"
            },
            "target": {
              "cell": "f0019501-d986-4817-88df-725fe5821e83",
              "port": "4677472f-cef5-4d9e-bdcf-63eac3b0f00c"
            },
            "vertices": [
              {
                "x": 510,
                "y": 360
              },
              {
                "x": 500,
                "y": 370
              },
              {
                "x": 470,
                "y": 430
              }
            ]
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "Web system/ Database",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "labels": [
              "Web system/ Database"
            ],
            "id": "41c87598-a8b8-415d-9488-ebbac56cd73c",
            "source": {
              "x": 800,
              "y": 290
            },
            "target": {
              "x": 1160,
              "y": 240
            },
            "vertices": [
              {
                "x": 870,
                "y": 280
              }
            ]
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "User/ Web-server",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "labels": [
              "User/ Web-server"
            ],
            "id": "4c2b39a3-45fd-4cff-b4c5-8c7fef60b32e",
            "source": {
              "x": 440,
              "y": 210
            },
            "target": {
              "x": 820,
              "y": -160
            },
            "vertices": [
              {
                "x": 570,
                "y": 90
              }
            ]
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "Bank/ Web-Server",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "labels": [
              "Bank/ Web-Server"
            ],
            "id": "ab010ca7-4071-4ae0-9dc2-43f7d627786a",
            "source": {
              "x": 0,
              "y": 50
            },
            "target": {
              "x": 290,
              "y": 430
            },
            "vertices": [
              {
                "x": 130,
                "y": 250
              },
              {
                "x": 200,
                "y": 350
              }
            ]
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "Admin/database",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "labels": [
              "Admin/database"
            ],
            "id": "725eecbf-2d1c-41b6-9bd9-d9c0e897a279",
            "source": {
              "x": 550,
              "y": 740
            },
            "target": {
              "x": 690,
              "y": 370
            },
            "vertices": [
              {
                "x": 570,
                "y": 680
              }
            ]
          }
        ],
        "description": "This STRIDE diagram models security threats for a digital banking platform inspired by the Capitec mobile banking app, aligning with the StellarPay scenario. Using the STRIDE framework (Spoofing, Tampering, Repudiation, Information Disclosure, Denial of Service, Elevation of Privilege), the diagram maps threats across key components such as the login system, API gateways, user account management, bank integrations, and mobile-to-server communication flows. It highlights potential attack vectors and trust boundaries found in real-world financial apps to guide threat mitigation and secure system design before deployment."
      }
    ],
    "diagramTop": 1,
    "reviewer": "Mr Tshiyole",
    "threatTop": 12
  }
}